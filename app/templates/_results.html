<div id="results" class="space-y-3" data-markers='{{ results | tojson }}'>
  {% if count == 0 %}
    <div class="p-4 rounded border">No matching restaurants. Try widening your radius or removing filters</div>
  {% else %}
    {% for r in results %}
      <div class="p-4 rounded border flex items-center justify-between" data-restaurant-id="{{ r.id }}">
        <div>
          <div class="font-semibold">{{ r.name }}</div>
          <div class="text-sm opacity-75">
            {{ r.distance_km }} km |
            {% if r.price == 1 %}$ {% elif r.price == 2 %}$$ {% elif r.price == 3 %}$$$ {% else %}-{% endif %}
            | {{ r.busy }}{% if r.halal %} | Halal{% endif %}
          </div>
        </div>

        <button class="px-3 py-2 text-sm bg-emerald-600 text-white rounded" hex-post="/checkin/{{ r.id }}" hx-target="#results" hx-swap="outerHTML" hx-include="#filters">
          I'm here
        </button>
      </div>
      <div class="mt-3">
        <button type="button" class="px-3 py-2 rounded bg-emerald-600 text-white" hx-get="/search" hx-include="#filters" hx-vals='{"enrich":"1"}' hx-target="#results" hx-swap="outerHTML" hx-indicator="#loading">
          Load more nearby (OpenStreetMap)
        </button>
        <span id="loading" class="htmx-indicator ml-2 text-sm opacit-70">Loadiing...</span>
      </div>
    {% endfor %}
  {% endif %}
</div>

